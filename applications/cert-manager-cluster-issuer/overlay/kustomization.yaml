apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: cert-manager

configMapGenerator:
  - name: env-properties
    env: env.properties

generatorOptions:
  disableNameSuffixHash: true

resources:
  - ../base

# components:
#   - ../components/prep-env

replacements:
  - source:
      kind: ConfigMap
      version: v1
      name: env-properties
      fieldPath: data.ACME_EMAIL
    targets:
      - select:
          group: cert-manager.io
          version: v1
          kind: ClusterIssuer
          name: letsencrypt-prod-dns01
        fieldPaths:
          - spec.acme.email