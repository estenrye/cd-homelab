apiVersion: minio.min.io/v2
kind: Tenant
metadata:
  name: minio
  namespace: minio-tenant
spec:
  requestAutoCert: false
  exposeServices:
    console: true
    minio: true
  env:
    - name: MINIO_DOMAIN
      value: "minio.monitoring.rye.ninja"
    - name: MINIO_BROWSER_REDIRECT_URL
      value: "https://console.minio.monitoring.rye.ninja"
    - name: MINIO_SERVER_URL
      value: "https://api.minio.minio.monitoring.rye.com"
  pools:
  - affinity:
      podAntiAffinity:
        requiredDuringSchedulingIgnoredDuringExecution:
        - labelSelector:
            matchExpressions:
            - key: v1.min.io/tenant
              operator: In
              values:
              - minio
            - key: v1.min.io/pool
              operator: In
              values:
              - pool-0
          topologyKey: kubernetes.io/hostname
    name: pool-0
    resources:
      requests:
        cpu: "2"
        memory: 2Gi
    servers: 4
    volumeClaimTemplate:
      metadata:
        name: data
      spec:
        accessModes:
        - ReadWriteOnce
        resources:
          requests:
            storage: "412316860416"
        storageClassName: direct-csi-min-io
    volumesPerServer: 4
  # prometheus:
  #   diskCapacityGB: 5
  #   securityContext:
  #     fsGroup: 1000
  #     fsGroupChangePolicy: Always
  #     runAsGroup: 1000
  #     runAsNonRoot: true
  #     runAsUser: 1000
  #   storageClassName: direct-csi-min-io